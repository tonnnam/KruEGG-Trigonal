import React, { useState, useEffect } from 'react';
import { CheckCircle, XCircle, Star, Trophy, ArrowRight, Infinity, Flame } from 'lucide-react';

const TrigonometryGame = () => {
  const [currentLevel, setCurrentLevel] = useState(1);
  const [score, setScore] = useState(0);
  const [streak, setStreak] = useState(0);
  const [bestStreak, setBestStreak] = useState(0);
  const [userAnswer, setUserAnswer] = useState('');
  const [feedback, setFeedback] = useState('');
  const [isCorrect, setIsCorrect] = useState(null);
  const [showHint, setShowHint] = useState(false);
  const [currentProblem, setCurrentProblem] = useState(null);

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°
  const generateProblem = (level) => {
    const angles = [0, 30, 45, 60, 90, 120, 135, 150, 180, 210, 225, 240, 270, 300, 315, 330];
    const radianAngles = ['0', 'œÄ/6', 'œÄ/4', 'œÄ/3', 'œÄ/2', '2œÄ/3', '3œÄ/4', '5œÄ/6', 'œÄ', '7œÄ/6', '5œÄ/4', '4œÄ/3', '3œÄ/2', '5œÄ/3', '7œÄ/4', '11œÄ/6'];
    const functions = ['sin', 'cos', 'tan'];
    
    const problemTypes = [
      // Level 1-3: Basic trig values
      {
        weight: level <= 3 ? 80 : 20,
        generate: () => {
          const angle = angles[Math.floor(Math.random() * 8)]; // ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏°‡∏∏‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
          const func = functions[Math.floor(Math.random() * 3)];
          const values = {
            sin: { 0: '0', 30: '0.5', 45: '0.707', 60: '0.866', 90: '1', 120: '0.866', 135: '0.707', 150: '0.5', 180: '0' },
            cos: { 0: '1', 30: '0.866', 45: '0.707', 60: '0.5', 90: '0', 120: '-0.5', 135: '-0.707', 150: '-0.866', 180: '-1' },
            tan: { 0: '0', 30: '0.577', 45: '1', 60: '1.732', 120: '-1.732', 135: '-1', 150: '-0.577', 180: '0' }
          };
          
          const answer = values[func][angle];
          if (!answer || (func === 'tan' && (angle === 90 || angle === 270))) {
            return generateProblem(level); // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏´‡∏£‡∏∑‡∏≠ tan ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤
          }
          
          return {
            question: `‡∏´‡∏≤ ${func}(${angle}¬∞)`,
            answer: answer,
            alternatives: getAlternativeAnswers(func, angle, answer),
            hint: `‡πÉ‡∏ä‡πâ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏∏‡∏°‡∏â‡∏≤‡∏Å‡∏û‡∏¥‡πÄ‡∏®‡∏©`,
            explanation: `${func}(${angle}¬∞) = ${answer}`
          };
        }
      },
      
      // Level 4-6: Pythagorean identity
      {
        weight: level >= 4 && level <= 8 ? 40 : level > 8 ? 20 : 0,
        generate: () => {
          const angle = angles[Math.floor(Math.random() * angles.length)];
          const types = [
            { q: `sin¬≤(${angle}¬∞) + cos¬≤(${angle}¬∞)`, a: '1', h: 'Pythagorean identity: sin¬≤Œ∏ + cos¬≤Œ∏ = 1' },
            { q: `1 + tan¬≤(${angle}¬∞)`, a: 'sec¬≤(' + angle + '¬∞)', h: 'Identity: 1 + tan¬≤Œ∏ = sec¬≤Œ∏', alt: [`1/cos¬≤(${angle}¬∞)`] },
            { q: `1 + cot¬≤(${angle}¬∞)`, a: 'csc¬≤(' + angle + '¬∞)', h: 'Identity: 1 + cot¬≤Œ∏ = csc¬≤Œ∏', alt: [`1/sin¬≤(${angle}¬∞)`] }
          ];
          const type = types[Math.floor(Math.random() * types.length)];
          
          if (type.a === '1') {
            return {
              question: type.q,
              answer: '1',
              alternatives: ['1', '1.0'],
              hint: type.h,
              explanation: `${type.q} = 1 (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏°‡∏∏‡∏° Œ∏)`
            };
          }
          
          return {
            question: type.q,
            answer: type.a,
            alternatives: type.alt || [type.a],
            hint: type.h,
            explanation: `${type.q} = ${type.a}`
          };
        }
      },
      
      // Level 5+: Double angle formulas
      {
        weight: level >= 5 ? 30 : 0,
        generate: () => {
          const angle = [15, 22.5, 30, 45, 60][Math.floor(Math.random() * 5)];
          const formulas = [
            { q: `sin(${2*angle}¬∞)`, f: 'sin', hint: 'sin(2Œ∏) = 2sin(Œ∏)cos(Œ∏)' },
            { q: `cos(${2*angle}¬∞)`, f: 'cos', hint: 'cos(2Œ∏) = cos¬≤(Œ∏) - sin¬≤(Œ∏)' }
          ];
          
          const formula = formulas[Math.floor(Math.random() * formulas.length)];
          const doubleAngle = 2 * angle;
          
          // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏£‡∏¥‡∏á
          const values = getExactTrigValue(formula.f, doubleAngle);
          
          return {
            question: `‡∏´‡∏≤ ${formula.q} ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏ï‡∏£‡∏°‡∏∏‡∏°‡∏Ñ‡∏π‡πà`,
            answer: values.decimal,
            alternatives: values.alternatives,
            hint: formula.hint,
            explanation: `${formula.q} = ${values.decimal}`
          };
        }
      },
      
      // Level 6+: Sum and difference formulas
      {
        weight: level >= 6 ? 25 : 0,
        generate: () => {
          const angle1 = [30, 45, 60][Math.floor(Math.random() * 3)];
          const angle2 = [30, 45, 60][Math.floor(Math.random() * 3)];
          const operation = Math.random() > 0.5 ? '+' : '-';
          const func = functions[Math.floor(Math.random() * 3)];
          
          const resultAngle = operation === '+' ? angle1 + angle2 : Math.abs(angle1 - angle2);
          const values = getExactTrigValue(func, resultAngle);
          
          const hints = {
            sin: `sin(A¬±B) = sin(A)cos(B) ¬± cos(A)sin(B)`,
            cos: `cos(A¬±B) = cos(A)cos(B) ‚àì sin(A)sin(B)`,
            tan: `tan(A¬±B) = (tan(A) ¬± tan(B))/(1 ‚àì tan(A)tan(B))`
          };
          
          return {
            question: `‡∏´‡∏≤ ${func}(${angle1}¬∞ ${operation} ${angle2}¬∞)`,
            answer: values.decimal,
            alternatives: values.alternatives,
            hint: hints[func],
            explanation: `${func}(${angle1}¬∞ ${operation} ${angle2}¬∞) = ${func}(${resultAngle}¬∞) = ${values.decimal}`
          };
        }
      },
      
      // Level 8+: Inverse trig functions
      {
        weight: level >= 8 ? 20 : 0,
        generate: () => {
          const values = [0, 0.5, 0.707, 0.866, 1];
          const value = values[Math.floor(Math.random() * values.length)];
          const func = ['arcsin', 'arccos', 'arctan'][Math.floor(Math.random() * 3)];
          
          const answers = {
            arcsin: { '0': '0', '0.5': '30', '0.707': '45', '0.866': '60', '1': '90' },
            arccos: { '0': '90', '0.5': '60', '0.707': '45', '0.866': '30', '1': '0' },
            arctan: { '0': '0', '0.5': '26.57', '0.707': '35.26', '0.866': '40.89', '1': '45' }
          };
          
          const answer = answers[func][value.toString()];
          
          return {
            question: `‡∏´‡∏≤ ${func}(${value}) ‡πÉ‡∏ô‡∏≠‡∏á‡∏®‡∏≤`,
            answer: answer,
            alternatives: [answer],
            hint: `${func} ‡∏Ñ‡∏∑‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ú‡∏Å‡∏ú‡∏±‡∏ô‡∏Ç‡∏≠‡∏á ${func.replace('arc', '')}`,
            explanation: `${func}(${value}) = ${answer}¬∞`
          };
        }
      },
      
      // Level 10+: Complex problems
      {
        weight: level >= 10 ? 15 : 0,
        generate: () => {
          const complexProblems = [
            {
              q: '‡∏ñ‡πâ‡∏≤ sin(Œ∏) = 3/5 ‡πÅ‡∏•‡∏∞ Œ∏ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏à‡∏ï‡∏∏‡∏†‡∏≤‡∏Ñ I ‡∏´‡∏≤ cos(Œ∏)',
              a: '0.8',
              alt: ['4/5', '0.8'],
              h: '‡πÉ‡∏ä‡πâ sin¬≤Œ∏ + cos¬≤Œ∏ = 1',
              e: 'cos¬≤(Œ∏) = 1 - sin¬≤(Œ∏) = 1 - (3/5)¬≤ = 1 - 9/25 = 16/25, ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô cos(Œ∏) = 4/5 = 0.8'
            },
            {
              q: '‡∏ñ‡πâ‡∏≤ tan(Œ∏) = 4/3 ‡∏´‡∏≤ sin(Œ∏) (‡∏Ñ‡πà‡∏≤‡∏ö‡∏ß‡∏Å)',
              a: '0.8',
              alt: ['4/5', '0.8'],
              h: '‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á tan, sin, cos',
              e: '‡∏ñ‡πâ‡∏≤ tan(Œ∏) = 4/3 ‡πÅ‡∏•‡πâ‡∏ß sin(Œ∏)/cos(Œ∏) = 4/3 ‡πÅ‡∏•‡∏∞ sin¬≤Œ∏ + cos¬≤Œ∏ = 1 ‡∏à‡∏∞‡πÑ‡∏î‡πâ sin(Œ∏) = 4/5 = 0.8'
            },
            {
              q: '‡πÅ‡∏Å‡πâ‡∏™‡∏°‡∏Å‡∏≤‡∏£ 2sin(x) - 1 = 0 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 0¬∞ ‚â§ x ‚â§ 360¬∞',
              a: '30, 150',
              alt: ['30 ‡πÅ‡∏•‡∏∞ 150', '30¬∞, 150¬∞', '30, 150'],
              h: '‡πÅ‡∏Å‡πâ‡∏´‡∏≤ sin(x) = 1/2 ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏≤‡∏°‡∏∏‡∏°‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î',
              e: 'sin(x) = 1/2, ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô x = 30¬∞ ‡πÅ‡∏•‡∏∞ x = 150¬∞'
            }
          ];
          
          const problem = complexProblems[Math.floor(Math.random() * complexProblems.length)];
          
          return {
            question: problem.q,
            answer: problem.a,
            alternatives: problem.alt,
            hint: problem.h,
            explanation: problem.e
          };
        }
      }
    ];
    
    // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ï‡∏≤‡∏° weight
    const totalWeight = problemTypes.reduce((sum, type) => sum + type.weight, 0);
    let random = Math.random() * totalWeight;
    
    for (const type of problemTypes) {
      random -= type.weight;
      if (random <= 0) {
        return type.generate();
      }
    }
    
    return problemTypes[0].generate(); // fallback
  };

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
  const getAlternativeAnswers = (func, angle, answer) => {
    const alternatives = [answer];
    
    // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏®‡∏©‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏©
    const fractionMap = {
      '0.5': '1/2',
      '0.707': '‚àö2/2',
      '0.866': '‚àö3/2',
      '0.577': '‚àö3/3',
      '1.732': '‚àö3',
      '-0.5': '-1/2',
      '-0.707': '-‚àö2/2',
      '-0.866': '-‚àö3/2',
      '-0.577': '-‚àö3/3',
      '-1.732': '-‚àö3'
    };
    
    if (fractionMap[answer]) {
      alternatives.push(fractionMap[answer]);
    }
    
    return alternatives;
  };

  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏µ‡πÇ‡∏Å‡∏ì‡∏°‡∏¥‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥
  const getExactTrigValue = (func, angle) => {
    const exactValues = {
      sin: {
        0: { decimal: '0', alternatives: ['0'] },
        15: { decimal: '0.259', alternatives: ['(‚àö6-‚àö2)/4'] },
        30: { decimal: '0.5', alternatives: ['1/2'] },
        45: { decimal: '0.707', alternatives: ['‚àö2/2'] },
        60: { decimal: '0.866', alternatives: ['‚àö3/2'] },
        75: { decimal: '0.966', alternatives: ['(‚àö6+‚àö2)/4'] },
        90: { decimal: '1', alternatives: ['1'] }
      },
      cos: {
        0: { decimal: '1', alternatives: ['1'] },
        15: { decimal: '0.966', alternatives: ['(‚àö6+‚àö2)/4'] },
        30: { decimal: '0.866', alternatives: ['‚àö3/2'] },
        45: { decimal: '0.707', alternatives: ['‚àö2/2'] },
        60: { decimal: '0.5', alternatives: ['1/2'] },
        75: { decimal: '0.259', alternatives: ['(‚àö6-‚àö2)/4'] },
        90: { decimal: '0', alternatives: ['0'] }
      }
    };
    
    return exactValues[func]?.[angle] || { decimal: '0', alternatives: ['0'] };
  };

  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏õ‡∏î‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà
  useEffect(() => {
    setCurrentProblem(generateProblem(currentLevel));
  }, [currentLevel]);

  const getDifficultyLevel = () => {
    if (currentLevel <= 3) return { name: '‡∏á‡πà‡∏≤‡∏¢', color: 'text-green-600', bg: 'bg-green-100' };
    if (currentLevel <= 6) return { name: '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á', color: 'text-yellow-600', bg: 'bg-yellow-100' };
    if (currentLevel <= 10) return { name: '‡∏¢‡∏≤‡∏Å', color: 'text-orange-600', bg: 'bg-orange-100' };
    return { name: '‡∏¢‡∏≤‡∏Å‡∏°‡∏≤‡∏Å', color: 'text-red-600', bg: 'bg-red-100' };
  };

  const checkAnswer = () => {
    if (!userAnswer.trim()) {
      setFeedback('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö');
      return;
    }

    const normalizedAnswer = userAnswer.trim().toLowerCase();
    const correctAnswers = [currentProblem.answer.toLowerCase(), ...currentProblem.alternatives.map(a => a.toLowerCase())];
    
    if (correctAnswers.includes(normalizedAnswer)) {
      setIsCorrect(true);
      const points = Math.max(5, 15 - Math.floor(currentLevel / 3)); // ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏•‡∏î‡∏•‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏î‡πà‡∏≤‡∏ô‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô
      setScore(score + points);
      setStreak(streak + 1);
      if (streak + 1 > bestStreak) {
        setBestStreak(streak + 1);
      }
      setFeedback(`‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! +${points} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô\n${currentProblem.explanation}`);
    } else {
      setIsCorrect(false);
      setStreak(0);
      setFeedback(`‡∏ú‡∏¥‡∏î! ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏≠ ${currentProblem.answer}\n${currentProblem.explanation}`);
    }
  };

  const nextLevel = () => {
    setCurrentLevel(currentLevel + 1);
    setUserAnswer('');
    setFeedback('');
    setIsCorrect(null);
    setShowHint(false);
  };

  const resetGame = () => {
    setCurrentLevel(1);
    setScore(0);
    setStreak(0);
    setUserAnswer('');
    setFeedback('');
    setIsCorrect(null);
    setShowHint(false);
  };

  const difficulty = getDifficultyLevel();

  if (!currentProblem) return <div>Loading...</div>;

  return (
    <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800 p-6">
      <div className="max-w-2xl mx-auto">
        {/* Header */}
        <div className="text-center mb-8">
          <h1 className="text-4xl font-bold text-white mb-2 flex items-center justify-center gap-2">
            üî¢ ‡πÄ‡∏Å‡∏°‡∏ï‡∏£‡∏µ‡πÇ‡∏Å‡∏ì‡∏°‡∏¥‡∏ï‡∏¥ <Infinity className="w-8 h-8 text-yellow-400" />
          </h1>
          <p className="text-purple-200">‡∏î‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î - ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏õ‡∏•‡∏≤‡∏¢</p>
        </div>

        {/* Stats */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
          <div className="bg-white/10 backdrop-blur rounded-lg p-4 text-center">
            <div className="text-2xl font-bold text-white">{currentLevel}</div>
            <div className="text-sm text-purple-200">‡∏î‡πà‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
          </div>
          <div className="bg-white/10 backdrop-blur rounded-lg p-4 text-center">
            <div className="text-2xl font-bold text-yellow-400 flex items-center justify-center gap-1">
              <Star className="w-5 h-5" />
              {score}
            </div>
            <div className="text-sm text-purple-200">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
          </div>
          <div className="bg-white/10 backdrop-blur rounded-lg p-4 text-center">
            <div className="text-2xl font-bold text-orange-400 flex items-center justify-center gap-1">
              <Flame className="w-5 h-5" />
              {streak}
            </div>
            <div className="text-sm text-purple-200">‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á</div>
          </div>
          <div className="bg-white/10 backdrop-blur rounded-lg p-4 text-center">
            <div className="text-2xl font-bold text-green-400">{bestStreak}</div>
            <div className="text-sm text-purple-200">‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</div>
          </div>
        </div>

        {/* Difficulty Badge */}
        <div className="flex justify-center mb-6">
          <div className={`${difficulty.bg} ${difficulty.color} rounded-full px-4 py-2 font-semibold`}>
            ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å: {difficulty.name}
          </div>
        </div>

        <div className="bg-white/10 backdrop-blur rounded-xl p-8 shadow-2xl border border-white/20">
          {/* Problem */}
          <div className="mb-8">
            <div className="bg-white/20 rounded-lg p-6 mb-4">
              <h3 className="text-xl font-semibold text-white mb-2">‡πÇ‡∏à‡∏ó‡∏¢‡πå:</h3>
              <p className="text-lg text-purple-100">{currentProblem.question}</p>
            </div>

            {/* Answer Input */}
            <div className="mb-4">
              <input
                type="text"
                value={userAnswer}
                onChange={(e) => setUserAnswer(e.target.value)}
                placeholder="‡πÉ‡∏™‡πà‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..."
                className="w-full p-4 border-2 border-white/30 rounded-lg focus:border-yellow-400 focus:outline-none text-lg bg-white/10 text-white placeholder-purple-200"
                onKeyPress={(e) => e.key === 'Enter' && checkAnswer()}
              />
            </div>

            {/* Buttons */}
            <div className="flex gap-3 mb-4">
              <button
                onClick={checkAnswer}
                className="flex-1 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white py-3 px-6 rounded-lg font-semibold transition-all transform hover:scale-105"
                disabled={!userAnswer.trim()}
              >
                ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
              </button>
              <button
                onClick={() => setShowHint(!showHint)}
                className="bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 text-white py-3 px-6 rounded-lg font-semibold transition-all transform hover:scale-105"
              >
                {showHint ? '‡∏ã‡πà‡∏≠‡∏ô‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ' : '‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ'}
              </button>
            </div>

            {/* Hint */}
            {showHint && (
              <div className="bg-yellow-400/20 border-l-4 border-yellow-400 p-4 mb-4 rounded">
                <p className="text-yellow-100">
                  <strong>‡∏Ñ‡∏≥‡πÉ‡∏ö‡πâ:</strong> {currentProblem.hint}
                </p>
              </div>
            )}

            {/* Feedback */}
            {feedback && (
              <div className={`p-4 rounded-lg mb-4 ${
                isCorrect === true 
                  ? 'bg-green-400/20 border-l-4 border-green-400' 
                  : isCorrect === false 
                  ? 'bg-red-400/20 border-l-4 border-red-400'
                  : 'bg-blue-400/20 border-l-4 border-blue-400'
              }`}>
                <div className="flex items-start gap-2">
                  {isCorrect === true && <CheckCircle className="text-green-400 w-5 h-5 mt-0.5 flex-shrink-0" />}
                  {isCorrect === false && <XCircle className="text-red-400 w-5 h-5 mt-0.5 flex-shrink-0" />}
                  <pre className={`whitespace-pre-wrap ${
                    isCorrect === true 
                      ? 'text-green-100' 
                      : isCorrect === false 
                      ? 'text-red-100'
                      : 'text-blue-100'
                  }`}>
                    {feedback}
                  </pre>
                </div>
              </div>
            )}

            {/* Next Button */}
            {isCorrect === true && (
              <button
                onClick={nextLevel}
                className="w-full bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white py-3 px-6 rounded-lg font-semibold transition-all transform hover:scale-105 flex items-center justify-center gap-2"
              >
                ‡πÑ‡∏õ‡∏î‡πà‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ
                <ArrowRight className="w-5 h-5" />
              </button>
            )}
          </div>
        </div>

        {/* Reset Button */}
        <div className="text-center mt-6">
          <button
            onClick={resetGame}
            className="bg-white/20 hover:bg-white/30 text-white py-2 px-6 rounded-lg font-semibold transition-colors"
          >
            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà
          </button>
        </div>
      </div>
    </div>
  );
};

export default TrigonometryGame;
